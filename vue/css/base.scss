@use "sass:math";

#app {
  font-family: Avenir, Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

:root {
  --suit-red: #c00;
  --suit-black: #111;
  --suit-blue: #0040ff;
  --suit-green: #0c0;
  --text-color: #efefdd;
  --card-background-color: #efefdd;
  --card-width: calc(25 * 5px);
  --card-height: calc(35 * 5px);
  --card-animation-time: 222ms;
}

.card {
  margin: 4px;
  display: inline-block;
  position: relative;
  filter: drop-shadow(6px 3px 6px #000b);
  height: var(--card-height);
  width: var(--card-width);

  transform-style: preserve-3d;
  perspective: 500px;
}

.card-face, .card-back {
  backface-visibility: hidden;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 4px;
}

.card-face {
  background: var(--card-background-color);
  fill: var(--suit-black);
  stroke: var(--suit-black);
  rotate: y 0deg;

  .face-down & {
    rotate: y 180deg;
  }

  .black & {
    fill: var(--suit-black);
    stroke: var(--suit-black);
  }

  .red & {
    fill: var(--suit-red);
    stroke: var(--suit-red);
  }

  .blue & {
    fill: var(--suit-blue);
    stroke: var(--suit-blue);
  }

  .green & {
    fill: var(--suit-green);
    stroke: var(--suit-green);
  }
}

.card-back {
  border: solid 4px var(--card-background-color);
  box-sizing: border-box;
  background: purple;
  rotate: y -180deg;

  .face-down & {
    rotate: y 0deg;
  }
}

.animate-cards {
  & .card, & .card-face, & .card-back {
    transition: ease-out transform var(--card-animation-time), ease-in rotate var(--card-animation-time);
  }
}

@mixin fan($count, $angle) {
  $offset: -$angle / 2;
  @for $i from 1 through $count {
    $increment: $angle / ($count + 1);
    .card:nth-child(#{$i}) {
      transform: translate(-50%, -50%) rotate($offset + $increment * $i);
    }
  }
}

@mixin allTheFans($counts, $angle) {
  $offset: math.div(-$angle, 2);
  @for $count from 1 through $counts {
    .card:first-child:nth-last-child(#{$count}),
    .card:first-child:nth-last-child(#{$count}) ~ .card {
      @for $i from 1 through $count {
        $increment: math.div($angle, ($count + 1));
        &:nth-child(#{$i}) {
          transform: translate(-50%, 6%) rotate($offset + $increment * $i);
        }
      }
    }
  }
}

.fan {
  width: calc(var(--card-height) * 2.2);
  height: calc(var(--card-height) * 1.4);
  position: relative;
  display: inline-block;
  text-align: center;
  @include allTheFans(16, 90deg);

  .card {
    position: absolute;
    transform-origin: 50% 125%;
  }
}

.full-height {
  height: 100vh;
}